angular.module("losofacebook",["ngSanitize","ngCookies","losofacebook.filters","losofacebook.services","losofacebook.directives"]).constant("user","gaylord.lohiposki").value("currentUser",{"firstName":"Gaylord","lastName":"Lohiposki","primaryImageId":469,"id":2469079,"username":"gaylord.lohiposki"}).config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){$locationProvider.html5Mode(true);$routeProvider.when("/",{controller:IndexCtrl,templateUrl:"/views/index.html"}).when("/person/:username",
{controller:PersonCtrl,templateUrl:"/views/person.html"}).when("/company",{controller:CompaniesCtrl,templateUrl:"/views/companies.html"}).when("/company/:name",{controller:CompanyCtrl,templateUrl:"/views/company.html"}).otherwise({redirectTo:"/person/gaylord.lohiposki"})}]).run(function($cookies,$browser,user,currentUser,$rootScope){$cookies.user=user;console.debug(currentUser);$rootScope.currentUser=currentUser});angular.module("losofacebook.services",["ngResource"]).value("version","0.1").factory("Company",function($resource){return $resource("/api/company/:name",{},{})}).factory("Person",function($resource){return $resource("/api/person/:username",{},{})}).factory("Post",function($resource){return $resource("/api/post/:person",{"person":"@personId"},{query:{method:"GET",params:{},isArray:true}})}).factory("Comment",function($resource){return $resource("/api/post/:postId/comment",{"postId":"@postId"},{})}).factory("Friend",
function($resource){return $resource("/api/person/:username/friend",{},{})});function IndexCtrl($scope,Person){$scope.user={};$scope.search=function(){var user=angular.copy($scope.user);user.first_name=(user.first_name||"")+"%";user.last_name=(user.last_name||"")+"%";$scope.results=Person.query(user,function(data){spinner.stop()})}}
function PersonCtrl($scope,$routeParams,Person,Post,Friend){$scope.posts=[];$scope.person=Person.get({username:$routeParams.username},function(person){$scope.backgroundImage="http://place.manatee.lc/"+person.backgroundId+"/1170/300.jpg";$scope.profileImage="/images/"+person.primaryImageId+"-midl.jpg";$scope.birthdayx=Friend.query({"username":person.username,"birthday":true})})}function CompaniesCtrl($scope,Company){$scope.companies=Company.query({"orderBy":"name ASC"},function(companies){})}
function CompanyCtrl($scope,$routeParams,Company,Person){$scope.company=Company.get({"name":$routeParams.name},function(company){$scope.backgroundImage="http://place.manatee.lc/"+company.backgroundId+"/1170/300.jpg";$scope.profileImage="/images/"+company.primaryImageId+"-mid.jpg";$scope.persons=Person.query({"company":company.name})})};angular.module("losofacebook.filters",[]).filter("interpolate",["version",function(version){return function(text){return String(text).replace(/\%VERSION\%/mg,version)}}]);angular.module("losofacebook.directives",[]).directive("appVersion",["version",function(version){return function(scope,elm,attrs){elm.text(version)}}]);angular.module("losofacebook.directives",[]).directive("onEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){if(event.which===13){scope.$apply(function(){scope.$eval(attrs.onEnter)});event.preventDefault()}})}});
angular.module("losofacebook.directives",[]).directive("lbFriends",function factory(){var directiveDefinitionObject={restrict:"E",templateUrl:"/views/directives/friends.html",replace:true,scope:{"friends":"=friends"},link:function postLink(scope,element,attrs){}};return directiveDefinitionObject}).directive("lbWall",function factory(Post,Comment,currentUser){var directiveDefinitionObject={restrict:"E",templateUrl:"/views/directives/posts.html",replace:true,scope:{"person":"=person"},link:function(scope,
element,attrs){scope.doPost=function(person,post){var post=new Post({"personId":person.id,"content":post,"poster":currentUser,"comments":[]});post.$save();scope.posts.unshift(post);this.post=""};scope.postComment=function(post,comment){var comment=new Comment({"postId":post.id,"content":comment,"poster":currentUser});post.comments.push(comment);comment.$save();this.comment=""};scope.$watch("person",function(person){if(person.id)scope.posts=Post.query({"person":person.id})},true)}};return directiveDefinitionObject});
